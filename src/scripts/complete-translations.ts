import { createClient } from '@/lib/supabase/server';
import { logger } from '@/lib/logger';

// Comprehensive translation keys for the entire system
const translationKeys = {
  // Common
  common: {
    loading: 'ุฌุงุฑู ุงูุชุญููู...',
    saving: 'ุฌุงุฑู ุงูุญูุธ...',
    submitting: 'ุฌุงุฑู ุงูุฅุฑุณุงู...',
    processing: 'ุฌุงุฑู ุงููุนุงูุฌุฉ...',
    creating: 'ุฌุงุฑู ุงูุฅูุดุงุก...',
    updating: 'ุฌุงุฑู ุงูุชุญุฏูุซ...',
    deleting: 'ุฌุงุฑู ุงูุญุฐู...',
    activating: 'ุฌุงุฑู ุงูุชูุนูู...',
    cancel: 'ุฅูุบุงุก',
    confirm: 'ุชุฃููุฏ',
    save: 'ุญูุธ',
    edit: 'ุชุนุฏูู',
    delete: 'ุญุฐู',
    view: 'ุนุฑุถ',
    back: 'ุฑุฌูุน',
    next: 'ุงูุชุงูู',
    previous: 'ุงูุณุงุจู',
    submit: 'ุฅุฑุณุงู',
    search: 'ุจุญุซ',
    filter: 'ุชุตููุฉ',
    clear: 'ูุณุญ',
    reset: 'ุฅุนุงุฏุฉ ุชุนููู',
    close: 'ุฅุบูุงู',
    open: 'ูุชุญ',
    yes: 'ูุนู',
    no: 'ูุง',
    ok: 'ููุงูู',
    error: 'ุฎุทุฃ',
    success: 'ูุฌุญ',
    warning: 'ุชุญุฐูุฑ',
    info: 'ูุนูููุงุช',
    required: 'ูุทููุจ',
    optional: 'ุงุฎุชูุงุฑู',
    all: 'ุงููู',
    none: 'ูุง ุดูุก',
    select: 'ุงุฎุชุฑ',
    select_all: 'ุงุฎุชูุงุฑ ุงููู',
    deselect_all: 'ุฅูุบุงุก ุงุฎุชูุงุฑ ุงููู',
    activated: 'ููุนู',
    pending: 'ูุนูู',
    completed: 'ููุชูู',
    failed: 'ูุดู',
    unknown: 'ุบูุฑ ูุนุฑูู',
    excellent: 'ููุชุงุฒ',
    good: 'ุฌูุฏ',
    needs_improvement: 'ูุญุชุงุฌ ุชุญุณูู',
  },

  // Authentication
  auth: {
    login: 'ุชุณุฌูู ุงูุฏุฎูู',
    logout: 'ุชุณุฌูู ุงูุฎุฑูุฌ',
    register: 'ุฅูุดุงุก ุญุณุงุจ',
    forgot_password: 'ูุณูุช ูููุฉ ุงููุฑูุฑ',
    reset_password: 'ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ',
    verify_email: 'ุชุฃููุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู',
    welcome: 'ูุฑุญุจุงู',
    unauthorized: 'ุบูุฑ ูุตุฑุญ',
    insufficient_permissions: 'ุตูุงุญูุงุช ุบูุฑ ูุงููุฉ',
    back_to_login: 'ุงูุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู',
    login_required: 'ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู',
    session_expired: 'ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ',
  },

  // Patient Dashboard
  patient: {
    dashboard: {
      welcome: 'ูุฑุญุจุงู ุจู ูู ููุญุฉ ุงูุชุญูู',
      subtitle: 'ุฅุฏุงุฑุฉ ููุงุนูุฏู ููููู ุงูุทุจู',
      next_appointment: 'ุงูููุนุฏ ุงููุงุฏู',
      with_doctor: 'ูุน ุงูุทุจูุจ',
      no_appointments: 'ูุง ุชูุฌุฏ ููุงุนูุฏ',
      account_status: 'ุญุงูุฉ ุงูุญุณุงุจ',
      activation_status: 'ุญุงูุฉ ุงูุชูุนูู',
      insurance_status: 'ุญุงูุฉ ุงูุชุฃููู',
      quick_stats: 'ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ',
      total_appointments: 'ุฅุฌูุงูู ุงูููุงุนูุฏ',
      outstanding_payment: 'ุงููุจูุบ ุงููุณุชุญู',
    },
    actions: {
      book_appointment: 'ุญุฌุฒ ููุนุฏ',
      book_description: 'ุงุญุฌุฒ ููุนุฏุงู ุฌุฏูุฏุงู',
      book_now: 'ุงุญุฌุฒ ุงูุขู',
      view_file: 'ุนุฑุถ ุงูููู',
      file_description: 'ุนุฑุถ ูููู ุงูุทุจู',
      open_file: 'ูุชุญ ุงูููู',
      file_locked: 'ุงูููู ูููู',
      payments: 'ุงููุฏููุนุงุช',
      payments_description: 'ุฅุฏุงุฑุฉ ูุฏููุนุงุชู',
      view_payments: 'ุนุฑุถ ุงููุฏููุนุงุช',
      insurance: 'ุงูุชุฃููู',
      insurance_description: 'ุฅุฏุงุฑุฉ ุชุฃูููู ุงูุตุญู',
      view_insurance: 'ุนุฑุถ ุงูุชุฃููู',
    },
    activation: {
      title: 'ุชูุนูู ุงูุญุณุงุจ',
      description: 'ูุฌุจ ุฅููุงู ุงูุฎุทูุงุช ุงูุชุงููุฉ ูุชูุนูู ุญุณุงุจู',
      progress: 'ุงูุชูุฏู',
      ready_to_activate: 'ุฌุงูุฒ ููุชูุนูู',
      activate_account: 'ุชูุนูู ุงูุญุณุงุจ',
      complete_step: 'ุฅููุงู ุงูุฎุทูุฉ',
      steps: {
        profile_complete: 'ุฅููุงู ุงูููู ุงูุดุฎุตู',
        profile_complete_desc: 'ุชุฃูุฏ ูู ุงูุชูุงู ุฌููุน ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ',
        insurance_verified: 'ุงูุชุญูู ูู ุงูุชุฃููู',
        insurance_verified_desc: 'ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุชุฃููู ุงูุตุญู',
        payment_settled: 'ุชุณููุฉ ุงููุฏููุนุงุช',
        payment_settled_desc: 'ุชุณููุฉ ุฌููุน ุงููุจุงูุบ ุงููุณุชุญูุฉ',
        first_visit: 'ุฅููุงู ุงูุฒูุงุฑุฉ ุงูุฃููู',
        first_visit_desc: 'ุฅููุงู ุงูุฒูุงุฑุฉ ุงูุฃููู ูุน ุงูุทุจูุจ',
      },
    },
    checklist: {
      title: 'ูุงุฆูุฉ ุงูุชุญูู ูุจู ุงูุฒูุงุฑุฉ',
      description: 'ูุฑุฌู ุฅููุงู ุงูุนูุงุตุฑ ุงูุชุงููุฉ ูุจู ููุนุฏู',
      progress: 'ุงูุชูุฏู',
      required_completed: 'ุงููุทููุจ ููุชูู',
      required_warning: 'ูุฌุจ ุฅููุงู ุฌููุน ุงูุนูุงุตุฑ ุงููุทููุจุฉ',
      submit: 'ุฅุฑุณุงู ุงููุงุฆูุฉ',
      categories: {
        documents: 'ุงููุณุชูุฏุงุช',
        payment: 'ุงูุฏูุน',
        health: 'ุงูุตุญุฉ',
        appointment: 'ุงูููุนุฏ',
      },
    },
  },

  // Doctor Dashboard
  doctor: {
    dashboard: {
      welcome: 'ูุฑุญุจุงู ุจู ุฏูุชูุฑ',
      subtitle: 'ุฅุฏุงุฑุฉ ูุฑุถุงู ูููุงุนูุฏู',
      today_appointments: 'ููุงุนูุฏ ุงูููู',
      total_patients: 'ุฅุฌูุงูู ุงููุฑุถู',
      pending_appointments: 'ุงูููุงุนูุฏ ุงููุนููุฉ',
      completed_today: 'ููุชูู ุงูููู',
      today_schedule: 'ุฌุฏูู ุงูููู',
      no_appointments_today: 'ูุง ุชูุฌุฏ ููุงุนูุฏ ุงูููู',
      recent_patients: 'ุงููุฑุถู ุงูุฃุฎูุฑูู',
      last_visit: 'ุขุฎุฑ ุฒูุงุฑุฉ',
      no_recent_patients: 'ูุง ุชูุฌุฏ ูุฑุถู ุญุฏูุซูู',
      quick_actions: 'ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ',
    },
    actions: {
      start_appointment: 'ุจุฏุก ุงูููุนุฏ',
      view_file: 'ุนุฑุถ ุงูููู',
      add_notes: 'ุฅุถุงูุฉ ููุงุญุธุงุช',
      view_all_patients: 'ุนุฑุถ ุฌููุน ุงููุฑุถู',
      manage_schedule: 'ุฅุฏุงุฑุฉ ุงูุฌุฏูู',
    },
  },

  // Staff Dashboard
  staff: {
    dashboard: {
      welcome: 'ูุฑุญุจุงู ุจู',
      subtitle: 'ุฅุฏุงุฑุฉ ุงููุฑุถู ูุงูููุงุนูุฏ',
      today_registrations: 'ุชุณุฌููุงุช ุงูููู',
      pending_payments: 'ุงููุฏููุนุงุช ุงููุนููุฉ',
      pending_claims: 'ุงููุทุงูุจุงุช ุงููุนููุฉ',
      today_activity: 'ูุดุงุท ุงูููู',
      pending_tasks: 'ุงูููุงู ุงููุนููุฉ',
      no_pending_payments: 'ูุง ุชูุฌุฏ ูุฏููุนุงุช ูุนููุฉ',
      no_pending_claims: 'ูุง ุชูุฌุฏ ูุทุงูุจุงุช ูุนููุฉ',
      no_recent_activity: 'ูุง ููุฌุฏ ูุดุงุท ุญุฏูุซ',
      quick_actions: 'ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ',
    },
    actions: {
      process_payment: 'ูุนุงูุฌุฉ ุงูุฏูุน',
      submit_claim: 'ุฅุฑุณุงู ุงููุทุงูุจุฉ',
      register_patient: 'ุชุณุฌูู ูุฑูุถ',
      view_patients: 'ุนุฑุถ ุงููุฑุถู',
      upload_claims: 'ุฑูุน ุงููุทุงูุจุงุช',
      generate_reports: 'ุฅูุดุงุก ุงูุชูุงุฑูุฑ',
    },
  },

  // Supervisor Dashboard
  supervisor: {
    dashboard: {
      welcome: 'ูุฑุญุจุงู ุจู',
      subtitle: 'ุฅุฏุงุฑุฉ ุงููุฑูู ูุงูุชูุงุฑูุฑ',
      total_patients: 'ุฅุฌูุงูู ุงููุฑุถู',
      total_appointments: 'ุฅุฌูุงูู ุงูููุงุนูุฏ',
      revenue: 'ุงูุฅูุฑุงุฏุงุช',
      claims_processed: 'ุงููุทุงูุจุงุช ุงููุนุงูุฌุฉ',
      staff_performance: 'ุฃุฏุงุก ุงููุฑูู',
      tasks: 'ุงูููุงู',
      efficiency: 'ุงูููุงุกุฉ',
      no_staff_data: 'ูุง ุชูุฌุฏ ุจูุงูุงุช ูุฑูู',
      system_alerts: 'ุชูุจููุงุช ุงููุธุงู',
      no_alerts: 'ูุง ุชูุฌุฏ ุชูุจููุงุช',
      reports: 'ุงูุชูุงุฑูุฑ',
      recent_reports: 'ุงูุชูุงุฑูุฑ ุงูุฃุฎูุฑุฉ',
      quick_actions: 'ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ',
    },
    actions: {
      daily_report: 'ุชูุฑูุฑ ูููู',
      monthly_report: 'ุชูุฑูุฑ ุดูุฑู',
      staff_report: 'ุชูุฑูุฑ ุงููุฑูู',
    },
  },

  // Insurance
  insurance: {
    claims: {
      title: 'ุฅุฏุงุฑุฉ ุงููุทุงูุจุงุช',
      create_new: 'ุฅูุดุงุก ูุทุงูุจุฉ ุฌุฏูุฏุฉ',
      search_placeholder: 'ุงูุจุญุซ ูู ุงููุทุงูุจุงุช...',
      all_statuses: 'ุฌููุน ุงูุญุงูุงุช',
      draft: 'ูุณูุฏุฉ',
      submitted: 'ูุฑุณูุฉ',
      under_review: 'ููุฏ ุงููุฑุงุฌุนุฉ',
      approved: 'ููุงููุฉ',
      rejected: 'ูุฑููุถุฉ',
      provider: 'ููุฏู ุงูุฎุฏูุฉ',
      select_provider: 'ุงุฎุชุฑ ููุฏู ุงูุฎุฏูุฉ',
      amount: 'ุงููุจูุบ',
      description: 'ุงููุตู',
      description_placeholder: 'ูุตู ุงูุฎุฏูุฉ ุงููุทููุจุฉ',
      diagnosis: 'ุงูุชุดุฎูุต',
      diagnosis_placeholder: 'ุชุดุฎูุต ุงูุญุงูุฉ',
      treatment: 'ุงูุนูุงุฌ',
      treatment_placeholder: 'ุงูุนูุงุฌ ุงูููุฏู',
      reference: 'ุงููุฑุฌุน',
      no_claims: 'ูุง ุชูุฌุฏ ูุทุงูุจุงุช',
      create: 'ุฅูุดุงุก',
      submit: 'ุฅุฑุณุงู',
      status: {
        draft: 'ูุณูุฏุฉ',
        submitted: 'ูุฑุณูุฉ',
        under_review: 'ููุฏ ุงููุฑุงุฌุนุฉ',
        approved: 'ููุงููุฉ',
        rejected: 'ูุฑููุถุฉ',
      },
    },
  },

  // Appointments
  appointment: {
    status: {
      pending: 'ูุนูู',
      confirmed: 'ูุคูุฏ',
      in_progress: 'ููุฏ ุงูุชูููุฐ',
      completed: 'ููุชูู',
      cancelled: 'ููุบู',
      no_show: 'ูู ูุญุถุฑ',
    },
  },

  // Payments
  payment: {
    status: {
      pending: 'ูุนูู',
      completed: 'ููุชูู',
      failed: 'ูุดู',
      refunded: 'ูุณุชุฑุฏ',
    },
  },

  // Reports
  report: {
    status: {
      ready: 'ุฌุงูุฒ',
      processing: 'ููุฏ ุงููุนุงูุฌุฉ',
      failed: 'ูุดู',
    },
  },
};

async function seedTranslations() {
  const supabase = await createClient();

  try {
    logger.info('๐ฑ Starting comprehensive translation seeding...');

    const translations = [];

    // Flatten the nested translation keys
    function flattenKeys(
      obj: any,
      prefix = ''
    ): Array<{ key: string; value: string }> {
      const result: Array<{ key: string; value: string }> = [];

      for (const [key, value] of Object.entries(obj)) {
        const fullKey = prefix ? `${prefix}.${key}` : key;

        if (typeof value === 'object' && value !== null) {
          result.push(...flattenKeys(value, fullKey));
        } else {
          result.push({ key: fullKey, value: value as string });
        }
      }

      return result;
    }

    const flatTranslations = flattenKeys(translationKeys);

    // Insert Arabic translations
    for (const translation of flatTranslations) {
      translations.push({
        lang_code: 'ar',
        key: translation.key,
        value: translation.value,
      });
    }

    // Insert English translations (basic fallbacks)
    for (const translation of flatTranslations) {
      const englishValue =
        translation.key.split('.').pop() || translation.value;
      translations.push({
        lang_code: 'en',
        key: translation.key,
        value: englishValue,
      });
    }

    logger.info(`๐ Total translations to insert: ${translations.length}`);

    // Insert translations in batches
    const batchSize = 100;
    for (let i = 0; i < translations.length; i += batchSize) {
      const batch = translations.slice(i, i + batchSize);

      const { error } = await supabase
        .from('translations')
        .upsert(batch, { onConflict: 'lang_code,key' });

      if (error) {
        logger.error(`Error inserting batch ${i / batchSize + 1}:`, error);
      } else {
        logger.info(
          `โ Inserted batch ${i / batchSize + 1}/${Math.ceil(translations.length / batchSize)}`
        );
      }
    }

    logger.info('๐ Comprehensive translation seeding completed!');
  } catch (error) {
    logger.error('โ Translation seeding failed:', error);
    throw error;
  }
}

// Run if called directly
if (require.main === module) {
  seedTranslations()
    .then(() => {
      logger.info('โ Translation seeding completed successfully!');
      process.exit(0);
    })
    .catch(error => {
      logger.error('๐ฅ Translation seeding failed:', error);
      process.exit(1);
    });
}

export { seedTranslations };
